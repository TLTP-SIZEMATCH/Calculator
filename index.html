<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TLTP Donor Calculator</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="TLTP Donor Calc">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="apple-touch-startup-image" href="splash/splash-2048x2732.png" media="(device-width: 682px) and (device-height: 910px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="splash/splash-1668x2388.png" media="(device-width: 556px) and (device-height: 796px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="splash/splash-1536x2048.png" media="(device-width: 512px) and (device-height: 682px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="splash/splash-1170x2532.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="splash/splash-1284x2778.png" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="splash/splash-1290x2796.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="splash/splash-1179x2556.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="splash/splash-1125x2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="splash/splash-1242x2688.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="splash/splash-828x1792.png" media="(device-width: 276px) and (device-height: 597px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <style>
    :root { --radius: 16px; }
    * { box-sizing: border-box; }
    body { font-family: -apple-system, system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin:0; padding:0; background:#ffffff; color:#111; min-height:100vh; }
    .wrap { width:100%; max-width:540px; margin:0 auto; padding:20px; display:flex; align-items:center; min-height:100vh; }
    .card { width:100%; background:#fff; border:1px solid #d0d0d0; border-radius:var(--radius); box-shadow:0 4px 16px rgba(0,0,0,0.1); overflow:hidden; }
    .head { padding:20px; background:#ffffff; border-bottom:1px solid #ddd; display:flex; align-items:center; gap:12px; }
    .head img { height:48px; width:auto; }
    h1 { font-size:1.25rem; margin:0; font-weight:700; color:#222; }
    .body { padding:20px; display:grid; gap:16px; }
    label { display:block; font-size:0.95rem; margin-bottom:8px; color:#333; }
    input[type="number"] { width:100%; padding:14px 12px; border-radius:12px; border:1px solid #ccc; background:#fafafa; color:#000; outline:none; font-size:1rem; }
    input[type="number"]::placeholder { color:#aaa; }
    .row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .btns { display:flex; gap:10px; flex-wrap:wrap; }
    button { appearance:none; border:1px solid #888; background:#f0f0f0; color:#000; padding:12px 14px; border-radius:12px; font-weight:600; cursor:pointer; }
    button.primary { background:#0066cc; color:#fff; border-color:#0066cc; }
    .result { border-top:1px dashed #ccc; padding-top:10px; display:grid; gap:10px; }
    .pill { display:inline-block; padding:6px 10px; border-radius:999px; font-weight:700; font-size:0.9rem; background:#0066cc; color:#fff; }
    .grid2 { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    .kv { background:#f9f9f9; border:1px solid #ccc; border-radius:12px; padding:12px; }
    .kv .k { font-size:0.8rem; color:#555; }
    .kv .v { font-size:1.2rem; font-weight:700; margin-top:4px; color:#000; }
    .foot { padding:14px 20px; border-top:1px solid #ddd; font-size:0.85rem; color:#555; }

    /* Static intro splash overlay */
    .splash { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:#ffffff; z-index:9999; transition: opacity .6s ease; }
    .splash.hide { opacity:0; pointer-events:none; }
    .splash-inner { text-align:center; }
    .splash-inner img { width:180px; height:auto; }
    .splash-title { font-weight:800; font-size:2.2rem; color:#0066cc; letter-spacing:0.06em; margin-top:12px; }
  </style>
</head>
<body>
  <div class="splash" id="splash">
    <div class="splash-inner">
      <img src="assets/logo.png" alt="TLTP logo">
      <div class="splash-title">TLTP</div>
    </div>
  </div>

  <div class="wrap">
    <div class="card">
      <div class="head">
        <img src="assets/logo.png" alt="TLTP logo">
        <h1>TLTP Donor Calculator</h1>
      </div>
      <div class="body">
        <div class="row">
          <div>
            <label for="predicted">Recipient Predicted TLC (pred)</label>
            <input id="predicted" type="number" step="any" inputmode="decimal" placeholder="e.g., 5.0">
          </div>
          <div>
            <label for="actual">Recipient Actual TLC (act)</label>
            <input id="actual" type="number" step="any" inputmode="decimal" placeholder="e.g., 2.0">
          </div>
        </div>
        <div class="btns">
          <button class="primary" id="calcBtn">Calculate</button>
          <button id="resetBtn">Reset</button>
        </div>
        <div class="result" id="result" hidden>
          <div><span class="pill" id="classif">—</span></div>
          <div class="grid2">
            <div class="kv">
              <div class="k">Donor Size (Min)</div>
              <div class="v" id="min">—</div>
            </div>
            <div class="kv">
              <div class="k">Donor Size (Max)</div>
              <div class="v" id="max">—</div>
            </div>
          </div>
          <div class="muted" id="note"></div>
        </div>
      </div>
      <div class="foot">
        Based on TLC thresholds: NEUTRAL (0.8·A ≤ C ≤ 1.2·A), OBSTRUCTIVE (C > 1.2·A), RESTRICTIVE (0.5·A ≤ C < 0.8·A), VERY SMALL (C < 0.5·A).
      </div>
    </div>
  </div>

  <script>
    function fmt(x) { return Number(x).toLocaleString(undefined, {maximumFractionDigits: 2}); }
    function compute(A, C) {
      if (C >= 0.8*A && C <= 1.2*A) return {classification:"NEUTRAL",minDonor:0.8*A,maxDonor:1.2*A,note:"Act is within ±20% of Pred"};
      if (C > 1.2*A) return {classification:"OBSTRUCTIVE",minDonor:A,maxDonor:1.2*A,note:"Act is more than 20% above Pred"};
      if (C < 0.8*A && C >= 0.5*A) return {classification:"RESTRICTIVE",minDonor:0.8*A,maxDonor:A,note:"Act is 20–50% below Pred"};
      return {classification:"RESTRICTIVE – VERY SMALL",minDonor:0.7*A,maxDonor:2*C,note:"Act is more than 50% below Pred
        "};
    }
    const $ = id => document.getElementById(id);
    const run = () => {
      const A = parseFloat($("predicted").value);
      const C = parseFloat($("actual").value);
      if (isNaN(A)||isNaN(C)){ $("result").hidden=true; return; }
      const r = compute(A,C);
      $("classif").textContent=r.classification;
      $("min").textContent=fmt(r.minDonor);
      $("max").textContent=fmt(r.maxDonor);
      $("note").textContent=r.note;
      $("result").hidden=false;
    };
    $("calcBtn").addEventListener("click",run);
    $("resetBtn").addEventListener("click",()=>{ $("predicted").value="";$("actual").value="";$("result").hidden=true; });

    // Fade out the static intro after a short delay
    window.addEventListener("load", () => {
      setTimeout(() => document.getElementById("splash").classList.add("hide"), 900);
    });

    // Register SW for offline
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => navigator.serviceWorker.register("service-worker.js").catch(console.error));
    }
  </script>
</body>
</html>
